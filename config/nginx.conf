events { worker_connections 1024; }
http {
  include mime.types;
  types_hash_max_size 4096;
  server {
    listen       443 ssl;
    server_name  etrial.sjy.id.au;
    client_max_body_size 4G;
    ssl_certificate        sjy.id.au.crt;
    ssl_certificate_key    sjy.id.au.key;
    ssl_client_certificate client.ca.crt;
    ssl_verify_client      on;

    location /keys { root /home/etrial; }
    location /files { root /home/etrial; }
    location /static { root /var/lib/etrial; }
    location / {
      proxy_pass http://127.0.0.1:8000;
      proxy_set_header X-SSL-Client-Certificate $ssl_client_escaped_cert;
    }
  }
}
