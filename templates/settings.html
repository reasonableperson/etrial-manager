{% extends "base.html" %}
{% from "macros.html" import matrix_row %}
{% block title %}Settings{% endblock %}

{% block content %}

<h2>Users</h2>

<table id="users">
  <tr>
    <th>Full name</th>
    <th>User</th>
    <th>Added</th>
    <th>Seen</th>
    <th>Admin</th>
    <th>Judge</th>
    <th>Jury</th>
    <th>Witness</th>
    <th>Delete</th>
  </tr>
  {% for login, user in users.items() %}
  <tr>
    <td>{{ user.real_name }}</td>
    <td>{{ login }}</td>
    <td class="added">
      {% if added in user %}
      <span class="date">{{ user.added | localise | long_date }}</span><br>
      <span class="time">{{ user.added | localise | long_time }}</span>
      <span class="tz">{{ user.added | localise | tz }}</span>
      {% endif %}
    </td>
    <td class="seen">
      <span class="date">{{ user.seen | localise | long_date }}</span><br>
      <span class="time">{{ user.seen | localise | long_time }}</span>
      <span class="tz">{{ user.seen | localise | tz }}</span>
    </td>
    {{ matrix_row('settings', name, user.status) }}
  </tr>
  {% endfor %}
  <tr>
    <form id="new-user" action="/settings/user/add" method="POST">
      <td><input name="name" placeholder="New user's full name ..."></td>
      <td colspan="8"><input type="submit" value="Add new user"/></td>
    </form>
  </tr>
</table>

<h2>Filesystem</h2>

<table>
  <tr>
    <th>Total storage</th>
    <td>{{ (fsdata.total / 2**30) | round }} GiB</td>
  </tr><tr>
    <th>Used storage (total)</th>
    <td>{{ (fsdata.used / 2**30) | round }} GiB
      ({{ (fsdata.used / fsdata.total * 100) | round }}%)</td>
  </tr><tr>
    <th>Used storage (case data)</th>
    <td>{{ (fsdata.crypt_used / 2**20) | round }} MB
      ({{ (fsdata.crypt_used / fsdata.total * 100) | round }}%)</td>
  </tr>
</table>

{% endblock %}
